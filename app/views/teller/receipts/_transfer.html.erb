<% debit_leg = posting_legs.find { |l| l.side == "debit" } %>
<% credit_leg = posting_legs.find { |l| l.side == "credit" } %>
<% from_ref = debit_leg&.account_reference %>
<% to_ref = credit_leg&.account_reference %>
<% from_account = from_ref.present? ? Account.find_by(account_number: from_ref) : nil %>
<% to_account = to_ref.present? ? Account.find_by(account_number: to_ref) : nil %>
<% from_masked = from_account ? masked_account_number(from_ref) : (from_ref || "—") %>
<% to_masked = to_account ? masked_account_number(to_ref) : (to_ref || "—") %>
<% meta = posting_batch.metadata || {} %>
<% meta = meta.with_indifferent_access if meta.respond_to?(:with_indifferent_access) %>
<% fee_cents = (meta["fee_cents"] || meta[:fee_cents] || 0).to_i %>

<table class="table table-xs text-xs w-full">
  <tr>
    <td>From:</td>
    <td><%= from_masked %></td>
  </tr>
  <tr>
    <td>To:</td>
    <td><%= to_masked %></td>
  </tr>
  <tr>
    <td>Amount:</td>
    <td class="tabular-nums"><%= receipt_money(teller_transaction.amount_cents) %></td>
  </tr>
  <% if fee_cents.positive? %>
    <tr>
      <td>Fee:</td>
      <td class="tabular-nums"><%= receipt_money(fee_cents) %></td>
    </tr>
  <% end %>
</table>

<%= render "teller/receipts/receipt_account_info", posting_batch: posting_batch %>
