<section class="card bg-base-100 border border-base-300">
  <div class="card-body">
    <div class="flex items-start justify-between gap-3">
      <div>
        <h2 class="card-title text-base">Branch & Workstation</h2>
        <p class="text-xs text-slate-600 mt-1">Set branch and workstation for this browser.</p>
      </div>
    </div>
    <div class="divider my-3"></div>
    <%= form_with url: teller_context_path,
      method: :patch,
      data: {
        controller: "teller-context",
        teller_context_workstations_by_branch_value: workstations_by_branch.to_json
      } do |form| %>
      <p class="form-control">
        <%= form.label :branch_id, "Branch", class: "block text-xs font-medium text-slate-700 mb-1" %>
        <%= form.select :branch_id,
          options_from_collection_for_select(branches, :id, :name, current_branch&.id),
          { include_blank: "Select branch" },
          {
            required: true,
            class: "select select-bordered w-full",
            data: {
              teller_context_target: "branch",
              action: "change->teller-context#branchChanged"
            }
          } %>
      </p>

      <p class="form-control">
        <%= form.label :workstation_id, "Workstation", class: "block text-xs font-medium text-slate-700 mb-1" %>
        <%= form.select :workstation_id,
          options_from_collection_for_select(workstations, :id, :name, current_workstation&.id),
          { include_blank: "Select workstation" },
          {
            required: true,
            class: "select select-bordered w-full",
            data: { teller_context_target: "workstation" }
          } %>
      </p>

      <%= form.submit "Update Context", class: "btn btn-outline" %>
    <% end %>
  </div>
</section>
